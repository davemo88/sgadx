\documentclass{article}

\usepackage[utf8]{inputenc}

\usepackage[T1]{fontenc}

\usepackage{geometry}
\geometry{a4paper}

\usepackage[english]{babel}

\usepackage{setspace}
\doublespacing

\usepackage{amsfonts}

\usepackage{amsmath}

\usepackage{bm}

\usepackage{tikz}
\usetikzlibrary{trees}

\title{Signaling Game Ad Exchange}

\author{David Kasofsky}

\date{May 1, 2016}

\begin{document}

\maketitle

\newpage

\tableofcontents

\newpage

\section{Introduction}

TODO

\newpage

\section{Signaling Games}

TODO: discuss crawford \& sobel

\subsection{Basic Model}

The crux of the signaling game is information asymmetry. One player has some information which is hidden from the other and wishes to convince the other to do something. Thus the informed player, called the Sender, must choose how to make his case while the second player, called the Receiver, must decide how to act based on the message from the Sender. As in typical game theory, both players wish to maximize their utility in this exchange. One can succinctly think of a signaling game definition requiring a sender, a receiver, some hidden information, the sender's possible messages, and the receiver's possible actions.

Such games are found to resemble interactions in nature, perhaps most famously described by Grafen \cite{grafen1} in his formalization of ideas from Zahavi \cite{zahavi1}. Here we see an example of signaling games used to describe mate selection. Consider a species in which the females choose which males to mate with and naturally want to select the best males. It is common for the male to signal his fitness by demonstrating a handicap, e.g. the cumbersome antlers of male deer. Since it is easier for healthier bucks to carry heavy antlers, antlers size generally indicates the buck's true fitness. In this the case the sender is the buck, the receiver is the doe, the hidden information is the fitness of the buck, the message is the size of antlers, and the action is to mate or not. 

Spence \cite{spence1} gives an example of how such games can model the hiring process. Here the sender is an applicant, the receiver is an employer, the hidden information is the competency of the applicant, the message is the credentials of the applicant, and the action is the wage offered to the applicant. Applicants want to be hired with the highest wage and employers want to pay applicants appropriately. Similarly to the antlers of deer, higher credentials are easier to earn for more competent applicants and so the employer may base his wages on the applicant's credentials.

A final example is simplified Poker. The sender has a winning hand or a losing hand and can send one of two messages: Bet or Check. The receiver can either Call or Fold.

To Bet signals a winning hand while to Check signals a losing one. The game is interesting because the sender may bluff by betting when he has a losing hand. 

With a few examples to build our intuition, we will shortly give a mathematical description of basic signaling games. We say basic here because we will extend this model in later games. First of all, a signaling game is a mathematical game like those studied in game theory. Game theory is generally interested in finding optimal strategies in multiplayer games. A game theoretical analysis almost always starts with assumptions about the goals, abilities, and rationality of the players, perhaps most importantly that the players will all play in such a way to maximize their score in the game. One can imagine player $i$'s score to be the output of some function $u_i$ and so $i$ will play so as to maximize $u_i$. This is a nice way to address arbitrary player preferences in complex or realistic games as such preferences are ultimately expressed by the value of $u_i$. 

These assumptions limit players' playable strategies, e.g. a player will not choose strategy A if it gives a lower score than strategy B. This brings us to the cornerstone of game theory: Nash equilibrium. A Nash equilibrium is a strategy assignment for each player such that each player's score is maximized given the strategies of the others. Thus a Nash Equilibrium is akin to a solution of a game since it gives each player a strategy which cannot be improved given the strategies of the other players. minimum of joint loss?

It is important to note the difference between pure and mixed strategies. A pure strategy is deterministic while a mixed strategy is probabilistic. Recall the Simple Poker game from above. A pure strategy for the sender is to bet winning hands and check losing hands. The best response for the receiver is then to fold to all bets and call all checks. This pair of strategies is not a Nash equilibrium because the sender's best response to the receiver's strategy is to bet losing hands as well, since the receiver will fold to all bets. 

An example of a mixed strategy is to always bet a winning hand and bet a losing hand half of the time. This time, however, we have a hiccup in choosing the receiver's best response strategy. Suppose the receiver knows the sender's strategy, i.e. that the sender is betting half of his losing hands. The receiver still does not know how often the sender is dealt a losing hand and so we need another tool in order to find the receiver's best response.

This brings us to the concept of Bayesian games. Signaling games are Bayesian games and thus so is the Simple Poker game. A Bayesian game is a game in which some information is hidden from the players. Imagine a set $\Omega$, elements of which represent possible gamestates. In the Simple Poker game, for example, $\Omega = \{\text{Winning Hand}, \text{Losing Hand}\}$. When a Bayesian game is initialized, an element of $\Omega$ is chosen and each player $i$ is assigned some probability distribution $\pi_{i}(\cdot)$ over $\Omega$, i.e. a prior belief over the possible gamestates. In the case of the signaling game, the sender $S$ is assigned $\pi_S(\cdot)$ which gives all mass to the correct gamestate.

Now we can address the receiver's best response in the Simple Poker game when the sender plays a mixed strategy. Recall that even if we knew how much the sender was bluffing, we could not choose a best response without also considering how often the sender had a winning hand. Let us now suppose that the receiver believes the sender has a winning hand half of the time, i.e. $\pi_R(\text{Losing Hand}) = 0.5$. Now it is straightforward to pick the best response strategy. Instead of folding to all bets as in the pure strategy response, the receiver should now call one third of the bets the sender makes. This is because if the sender is betting all his winning hands and half his losing ones, he will bet three quarters of all his hands and one third of those bets will be with losing hands. Naturally the values from the above payoff matrix were relevant in this reasoning but were chosen for our  at this point.

With these concepts in hand, we can concisely describe the basic signaling game. There are two players, $S$ and $R$. $S$ has some type $t \in T$ which is known to $S$ but unknown to $R$. $T$ is analogous to the set $\Omega$ from before. Each player also has a prior $ \pi_i(dcot)$ over $T$. One can imagine $\pi_{S}$ assigns probability 1 to $t$ and $\pi_{R}$ does not, e.g. $\pi_{R}$ could assign uniform probability to each $t \in T$. $S$ chooses a message $m$ from a set $M$ which is sent to $R$. Considering $m$ in light of $\pi_R$, $R$ chooses an action $a$ from a set $A$. Each player then receives a score according to functions $u_R$ and $u_S$ : $T \times M \times A \to \mathbb{R}$.
A strategy for S is then a function $\mu_{S}: T \times M \to [0,1]$ such that $\forall t: \sum_{m \in M} \mu_{S}(t, m) = 1$, i.e. assigns a probability to each message for all types. A strategy for R is a similarly $\mu_{R} : M \times A \to [0,1]$ such that $\forall m: \sum_{a \in A} \mu_{R}(m,a) = 1$.

A strategy for S is then a function $\mu_{S}: T \times M \to [0,1]$ such that $\forall t: \sum_{m \in M} \mu_{S}(t, m) = 1$, i.e. assigns a probability to each message for all types. A strategy for R is a similarly $\mu_{R} : M \times A \to [0,1]$ such that $\forall m: \sum_{a \in A} \mu_{R}(m,a) = 1$.

\subsection{Equilibria}

Three types of Nash equilibria exist in signaling games:

\begin{enumerate}
\item Separating Equilibria, in which each type of sender send different signals. That is:

$\forall t, t' \in T, \exists M_{t} \subset M$ with $\mu_S(t,m) > 0 \Rightarrow m \in M_{t}$ and $t \ne t' \Rightarrow M_{t} \cap M_{t'} = \emptyset$.

\item Pooling Equilibria, in which all types send the same message. That is: $\exists  m \in M, \forall t \in T : \mu_S(t,m) = 1$.

\item Mixed Equilibria, which fall into neither of the previous two categories. Senders of differing types may send the same messages but may not as well. 
\end{enumerate}

Because signaling games are games of information asymmetry, we can interpret strategies and equilibria in terms of deception. The informed player, S, can deceive the uninformed player R. Consider the Simple Poker game once more: to sometimes bet with losing hands is a deceptive strategy that exploits the receiver's ignorance. 

 For instance, a separating equilibrium suits games in which the sender and receiver have a common interest and so the sender does not necessarily wish to be deceptive. Rather the sender wants to confer the maximum amount of information about the hidden type via the signal.

In a separating equilibrium, the receiver is able to deduce the sender's type from signal. Since the sender's utility function $u_{S}$ and possible types $T_S$ are common knowledge, the receiver can deduce which signal would be sent by each type. This makes the receiver's choice of action straightforward and there is no deception by the sender.

In a pooling equilibrium, the sender confers no information about the hidden type as all senders send the same signal. In this case the receiver's strategy is independent of the signal and depends only on $\pi_{ R}$. This is maximally deceptive but so obviously as to render the signal meaningless.

\subsection{Costly Signaling}

Costly signaling is an important feature of many signaling games. Suppose $G$ is a signaling game with $M$ a real interval and consider $u_{S}(t,s,a)$.

\subsection{Iterated Signaling Games}

\subsection{Recommenders and Verifiers}

\newpage

\section{Online Advertising via Signaling Games}

Here we introduce a complex signaling game of our design: the Signaling Game Ad Exchange. 

The Signaling Game Ad Exchange is a signaling-game inspired model of an online ad exchange. We model the process of advertisers bidding on impressions and showing ads to consumers using two consecutive signaling games. 

The players in these games represent advertisers and consumers. Each player has a secret $N$-dimensional type vector which represents the products the advertiser / consumer wants to sell / buy. For example, a higher value in for one component of the vector indicates a greater affinity for the product the component represents.

In both games the messages (denoted by $\delta$ and $\alpha$) are $N$-dimensional unit vectors and the actions (denoted by $\beta$ and $\rho$) are scalars in $\lbrack 0, 1 \rbrack$. 

The first signaling game is the Auction Game. A consumer $C$ sends a content request $\delta$, e.g. for a web page or search result, and advertisers bid for the opportunity to show an ad amongst the content. The content request is again an $N$-dimensional vector describing how well-suited the content request is for certain products. The advertisers $A_1,...,A_K$ then gives bids $\beta_1,...\beta_K$ in a second price auction\cite{second_price_auctions}. The consumer receives a payoff equal to the dot product of their type $\tau_C$  and the content request $\delta$ while the winning advertiser receives a negative payoff equal to the second highest bid, i.e. the second price. The winning advertiser and consumer then go on to play the Ad Game.

\begin{equation}
	C \overset{\delta}{\longrightarrow} A_1,...,A_K: \beta_1,...,\beta_K
\end{equation}

\begin{equation}
	\mu_{C_{auction}}(\cdot) = \langle\tau_C, \delta\rangle
\end{equation}

\begin{equation}
	\mu_{A^*{auction}}(\cdot) = -\beta^*
\end{equation}

where $A^*$ is the advertiser with the highest bid and $\beta^*$ is the second-highest bid. $\langle \cdot \rangle$ denotes the dot product. We could also give this like the payoff to $A_i$ is the second highest bid when $\beta_i$ is the highest bid and 0 otherwise.

The intuition for these utility functions is as follows. Consumers want to consume content that suits them, and thus should be rewarded for similarity between their content requests $\delta$ and their type $\tau_C$. Advertisers need to pay for the opportunity to show an ad to a consumer. 

The second signaling game is the Ad Game. The winning advertiser from the auction game, $A^*$, send an ad $\alpha$ to the consumer $C$. The consumer then chooses an amount $\rho$. to interact with the ad. The advertiser receives payoff $1_{conv(C)}$ and the consumer receives payoff $ (1 + \rho) \langle \delta, \alpha \rangle -1$.

\begin{equation}
	A^* \overset{\alpha}{\longrightarrow} C : \rho
\end{equation}

\begin{equation}
	\mu_{A^*{ad}}(\cdot) = 0
\end{equation}

\begin{equation}
	\mu_{C_{ad}} = \langle \delta, \alpha \rangle + \rho \langle \delta, \alpha \rangle - 1 
\end{equation}

The intuition for these utility functions is as follows. Advertisers do not receive any immediate benefit from simply showing ads to consumers. Ads are shown for the long con, so to speak. They want to nudge consumers towards their brand and products over time. In order to get value, they need the consumers to convert (i.e.buy their product). On the other hand, ads generally annoying consumers. The $-1$ in the consumer's utility function is punishment for ads since ads detract from whatever browsing the consumer is up to. Furthermore if the ads do not suit the consumer's content request, they further annoy the consumer and hence the $\langle \delta, \alpha \rangle$. Now suppose the ads do suit the consumer's content request. Then the consumer has some incentive to interact with the ads, and hence the $\rho \langle \delta, \alpha \rangle$ term. The idea is that bad ads should detract from the consumer's browsing even if the consumer does not explicitly interact with them. However the consumer should have an incentive to engage appropriate ads.

Finally there is a stochastic conversion phase. This is meant to be an iterative game, e.g. we say $\delta_t$ is the content request sent during iteration $t$. After $t$ iterations, consumer $C$ converts for advertiser $A$ with probability:

\begin{equation}
	\langle (1 - \frac{1}{2t}\sum_{i=1}^{t} \rho_t) \tau_C + \frac{1}{2t}\sum_{i=1}^{t} \rho_t) \sum_{i=1}^{t} \frac{\rho_t \alpha_t}{2^{t-i}}, \tau_A \rangle \times \frac{1}{100}
\end{equation}

After the conversion phase, advertiser $A$ receives payoff one if $C$ converts for $A$ and $0$ otherwise. The consumer receives payoff $\langle \tau_C, \tau_A \rangle$ if $C$ converts for $A$ and $0$ otherwise.

The intuition here is as follows:

if the consumer never interacts with an ad, the ads should have no effect on the chance the consumer buys a certain product. If the consumer interacts a lot with ads, then the ads should affect the consumer's chance to convert, but never more than their innate affinities for certain products. Furthermore, ads that are further back in time should more effects than recent ones, and each ad should have an effect proportional to the amount the consumer interacted with it.

Note that since all vectors involved are unit vectors, we can interpret dot products as probabilities counting all negative dot products as a probability of $0$. The $\frac{1}{100}$ should be a hyperparameter if these methods were applied to particular case, since conversions tend to be quite rare compared to ad interactions but the rarity is specific to the advertiser.
\newpage


\section{Signaling Game Ad Exchange}

Thus far we have discussed the general landscape of digital advertising, some basics of game theory and signaling games, and how signaling games appear in advertising. Now we move to a complex game of our own design: the Signaling Game Ad Exchange. Imagine consumers browsing the web, visiting various web pages that suit their interests. Some of these pages will be listed on ad exchanges. When a consumer visits such a page, advertisers on the exchange bid on the available impression and the winning advertising's ad appears on the page. The consumer may then interact with the advertiser's ad, perhaps leading to a conversion. One consumer may visit many web pages so an advertiser frequently interacts with the same consumer multiple times. Over time, advertisers can use attribution to identify which ads are the most effective and which DMPs provide the best third party data. Our goal is to plausibly describe this process using signaling games. We focus first on the two most important pieces: impression auctions and consumer-ad interactions.

As such we will have two categories of players in our game: Consumers and Advertisers. Consumers wish to browse the net without interruption, e.g. from irrelevant advertisements. Consumers also want to purchase products which suit them. Advertisers want consumers to buy their products and encourage them to do so by showing ads. To capture all of this, we think of our Signal Game Ad Exchange broken into three phases: the Auction Phase, the Ad Phase, and the Conversion Phase. In the Auction Phase, we play a signaling game called the Auction Game. The sender is a consumer and the receivers are $n$ advertisers. The consumer sends impression metadata, which is bid on by the receiving advertisers in an auction. The winning advertiser and the consumer go on to the Ad Phase. We play a signaling game called the Ad Game, in which the winning advertiser is the sender and the consumer is the receiver. The advertiser's sends an ad to be shown to the consumer and the consumer decides how to interact with the ad. After both games have been played, the Conversion Phase occurs. In this phase the consumer randomly decides whether to convert, i.e. to buy an advertised product. This completes an iteration of the Signaling Game Ad Exchange. Utility functions are calculated in each phase of the game and a player's ultimate utility is the sum of the utilities calculated in each phase. TODO: insert figures

As both consumers and advertisers may play the role of sender, players from each category have associated types. The type space $T$ is the set of unit vectors in $\mathbb{R}^N$. The type of player $i$ is then some $t_i \in T$. Player type vectors should be interpreted as a list of product affinities. We imagine that there are different products or features of products; thus a consumer type vector describes the products the consumer would like to buy and an advertiser type vector describes the products the advertiser promotes.  As in the classic signaling game, each player $i$ knows only his own type $t_i$. The players' beliefs about unknown information in the game is represented by a Bayesian prior $\pi_i$ over $\Omega$, where $\Omega$ is the set of possible game variable configurations. 

So far we have introduced two hyperparameters of the game. $N$ is the number of products, which determines the dimension of the player types and, as we will see, their messages. $n$ is the number of advertisers which participate in the impression auctions. We will continue to refer to these hyperparameters throughout the following discussion of the Auction Phase and the Ad Phase. 

\subsection{Auction Phase}

In the first phase, the Auction Phase, we simply play a signaling game modeling an impression auction on an ad exchange. We call this the Auction Game. Here the sender is a consumer and the receivers are the $n$ advertisers who will bid on the impression. Consumers' messages represent impression metadata. Consumers choose the sort of impression metadata which is relayed to advertisers on the exchange by visiting certain types of sites. While the ad exchange technically delivers the impression metadata to advertisers, it is the consumer who determines its content. The consumer message space $M$ is again the set of unit vectors in $mathbb{R}^N$. The components of a consumer message vector $m \in M$ similarly correspond to product affinities, in this case for the web page the consumer is visiting. One can imagine that different types of web pages, various e-commerce pages in particular, could be more or less associated with certain types of products.

The advertisers on the exchange receive the impression metadata and must decide how much to bid for the available impression. The bid amount $\beta$ is the advertiser's action. The action space $A$ is the set of non-negative real numbers, $\mathbb{R}^{\ge 0}$. Each of the advertiser's bids are entered in a Vickrey auction \cite{vickrey_auctions} and the winner goes on to play the Ad Game. A Vickrey auction is a sealed price auction in which the winner pays the amount of the second-highest bid. A sealed-price auction is one in which bids are given without knowing the bids of other participants. This type of auction has been shown to encourage truthful bids (in particular circumstances), i.e. bids that reflect the bidder's actual evaluation of the item at auction. A generalized version, though with significantly different properties, is commonly used in the auction of search keywords \cite{edelman_gsp}. We choose this type of auction because of its influence on the development of auctions in digital advertising, e.g. the aforementioned search keyword auctions.

With the sender's messages and receivers' actions in hand, we may turn to the players' utility functions. The consumer's utility function $u_{auction_S}$ is the dot product of consumer's type and the impression metadata, i.e. $t_S \cdot m$. The intuition here is that the consumer's primary goal is to visit websites which suit their interests. Since consumer type and impression metadata are both unit vectors, the dot product is equal to the cosine of the angle between the vectors. Thus we interpret larger cosine, i.e. smaller angle between vectors, as a better match between taste (consumer's type) and content (impression metadata). A better match between consumer type, i.e. taste, and impression metadata, i.e. content, is better for the consumer. Now, at this point one may wonder how the advertisers' actions affect the consumer since they do not affect the utility function. The answer is they will affect the consumer's utility in the second game, the Ad Game.

The advertisers' utility function $u_{auction_R}$ is merely the auction result: the winning advertiser receives negative utility equal to the second highest bid and the others receive zero utility. The negative utility corresponds to the amount the winning advertiser must pay in order to show an ad. Once again, the consumer's message and type are absent from the utility function at this stage but will affect the advertiser's payoff in the ad game.

Let $U^N$ be the set of unit vectors in $\mathbb{R}^N$. We may summarize the game definition thus far as follows:

\begin{itemize}
	\item The sender $S$ is a consumer with type $t_S \in T_S = U^N$.
	\item The receiver $R$ is a set of advertisers, $R = \{r_1, r_2, ... r_{n-1}, r_n \}$, each with type $t_{R_i} \in T_R = U^N$.
	\item The message space $M$ = $U^N$ is the set of possible impression metadata sent by $S$.
	\item The action space $A = \mathbb{R}^{\ge 0}$ is the set of possible bids by members of $R$.
	\item The sender's utility function $u_{auction_S}(t_S, m) = t_S \cdot m$ where $m \in M$.
	\item The receivers' utility function $u_{auction_R}(a_1, a_2, ... a_{n-1}, a_n)$ is the Vickrey auction result.
\end{itemize}

\subsection{Ad Phase}

In the second phase, the Ad Phase, we play a signaling game modeling a consumer-ad interaction. We call this the Ad Game. The roles are reversed from the the Auction Game: the sender is an advertiser and the receiver is a consumer. The advertiser's message represents an ad, e.g. a banner ad. Ads are represented by $N$-dimensional unit vectors, the components of which once again correspond to product affinities. However: an advertiser may not simply send whatever message they chose. Instead, messages for advertiser $j$ are constrained to a set $M_j$ of size $\alpha$, $\alpha$ another hyperparameter of the game. The intuition is that an advertiser does not have myriad ads at his disposal. Instead advertisers must work with a small number, e.g. $\sim 10$, available ads and aim to deliver the most suitable ad he can. Additionally, advertisers do not know $\emph{a priori}$ which ads are best suited to particular situations. As ad messages are represented by vectors of product affinities, these vectors are akin to the types of the ads. So, much like advertisers do not know the types of consumers, advertisers do not know the types of their ads. Advertiser's beliefs about the types of their ads are reflected by the prior $\pi_i(\cdot)$.

The consumer receives the ad and must decide how to interact with it. The amount of interaction is represented by a number in $[0,1]$, with a higher value representing more interaction with the ad. Today's ads are quite sophisticated and interactive. As such, an ad may relay all kinds of consumer interaction data back to the advertiser. For example, a video ad will track how much of the video the consumer watches as well as whether they pause, restart, mute, full-screen, etc. Other ads may have interactive features like buttons, carousels of products, and mini-games and track how these features are used by a consumer. Thus there is a spectrum of possible ad interactions and the depth of interaction in particular instances is visible to the advertiser.

The advertiser simply receives 0 utility for this game, i.e. $u_{ad_S}(\cdot) = 0$. Because ad interaction does not generate revenue, the advertiser does not receive any explicit value from it. Instead the advertiser is hoping it pays off later in the form of a revenue-generating conversion which may occur in the Conversion Phase. The consumer utility function $u_{ad_R} = -a$, where $a$ is the amount of ad interaction. This is because ad interaction is a detraction from the consumer's regular browsing. However: consumers do wish to purchase suitable products and may only learn about them through advertising. Thus there is an incentive to interact with advertising as it may lead to a purchase.

Let us offer a short summary of the Ad Game:

\begin{itemize}
	\item The sender is an advertiser $\alpha_j$ with type $t_j$.
	\item The receiver is a consumer $\gamma_i$ with type $t_i$.
	\item The message space $M_j \subset U^N$ is the set of ads available to $\alpha_j$.
	\item The action space $A = [0,1]$ represents the possible amounts of consumer-ad interaction.
	\item The sender's utility function $u_{ad_S}(\cdot) = 0$.
	\item The receivers utility function $u_{ad_R}(a) = -a$, where $a \in A$.
\end{itemize}

\subsection{Conversion Phase}

At the conclusion of the Ad Phase, two random events occur. The first is consumer state transition. Consumers not only have a type but a dynamic state. A consumer's state, motivated by the marketing funnel, represents their interest in a certain product and hence their chance to convert. A consumer has a state with respect to each advertiser. The possible consumer states are:

\begin{enumerate}
	\item Ignorance: the consumer is ignorant of the advertiser and will convert with probability $p_Ignorance = 0$.
	\item Awareness: the consumer is aware of the advertiser and will convert with probability $p_Awareness << 0.01$.
	\item Interest: the consumer is interested in the advertiser and will convert with probability $p_Interest \sim 0.01$.
%	\item Rejection: the consumer has rejected the product and will convert with probability $p_Rejection = 0$s
TODO: rejection / adblock state to go in future directions
\end{enumerate}

A consumer's initial state with respect to an advertiser is determined by the choice of $\omega \in \Omega$. The states are ordered Ignorance, Awareness, Interest and consumers may only transition to the next state or remain in their current state. A consumer transitions to the next state with probability $max(0, a (t_i \cdot m_j))$, where $a$ is the amount of advertising interaction in the Ad Game, $t_i$ is the consumer's type, and $m_j$ is the ad sent by advertiser $j$ in the Ad Game. Recall $a \in [0,1]$ and $t_i \cdot m_j \in [-1,1]$ so that $max(0, a (t_i \cdot m_j)) \in [0,1]$. This means that consumers will have a higher chance to progress in the funnel the more they interact with an ad or the better an ad suits them. Ads that are unsuitable, i.e. have negative dot product, have no chance at affecting a consumer's state. See figure for state diagram.

TODO: insert figure

TODO: state with respect to product or advertiser? downside of with respect to advertiser is that advertiser's don't directly compete, e.g. one advertiser's ads may cause a consumer to transition to lower states in the funnel before receiving ads from a similar advertiser. downside of per product is that with unit vectors, it's not clear that a product per component interpretation is accurate. maybe that's better though.

Finally the consumer converts for each advertiser with probability according to their state with respect to that advertiser. Converting puts the consumer into a final pseudo-state ("converted") in which the consumer may not convert again for the same advertiser. The consumer and advertiser each receive 0 utility when there is no conversion. When there is a conversion for advertiser $j$ receives utility $v_j$, where $v_j$ is the value of the advertiser's product. The converting consumer $i$ receives utility $(t_i \cdot t_j) v_i$. That is, the consumer receives a fraction of the value of the product proportional to the alignment of $i$ and $j$'s type vectors.



\subsection{Third Party Data as Recommendation}

\subsection{Attribution as Verification}

\subsection{Consumers}

First, let us give a formal definition of a Consumer player. We will then address each attribute in detail.

A Consumer $C_i$ is a tuple $\langle t_i, f_i \rangle$ where:

\begin{itemize}
	\item $t_i \in U^N = \{\bm{x} | \bm{x} \in \mathbb{R}^N \wedge ||x|| = 1\}$ is the consumer's type
	\item $f_i \in F = \{ignorance, awareness, consideration, intention\}^N$ is the consumer's initial state in the funnel for each existing product type. 
\end{itemize}

Consumers in our game represent web-browsing consumers in real life. Each consumer player has a type $t_i$ which describes affinities for various types of products. These product affinities are represented by a $N$-dimensional unit vector, $N$ being a hyperparameter of the game. Each component of the consumer type vector corresponds to an affinity for a type of product. For example, a consumer with type vector $\rbrack 1, 0 \lbrack$ has an affinity for the first product but not for the second.

Consumers' messages represent impression metadata, as a consumer is the sender in the Auction Game. In essence, consumers choose the sort of impression metadata which is relayed to advertisers on the exchange by visiting certain types of sites. While the ad exchange technically delivers the impression metadata to advertisers, it is the consumer who determines its content. A consumer message, i.e. impression metadata, is also presented as a $N$-dimensional unit vector. The components of the impression metadata vector once again correspond to product affinities but for the web page the consumer is visiting. One can imagine that different types of web pages, various e-commerce pages in particular, could be more or less associated with certain types of products. 

Consumer actions correspond to advertising interactions. Recall the Consumer plays the role of receiver in the Ad Game. The set of possible consumer actions $A_{Consumer}$ is $\{view, click\}$. An $impression$ interaction means that the ad was displayed on the page but the consumer did not click on it where a $click$ interaction signifies that the consumer did click on the ad and was therefore linked to the advertiser's website. We also associate these actions with the probability of a consumer state transition. As described in the first section, advertisers believe in the marketing funnel and that consumers can be more or less receptive to advertisements depending on their position in funnel. So each consumer not only has a hidden type but also a hidden state $f_i$ which corresponds to their position in the funnel for each product type. We use a four-stage funnel $F$ with states $\{ignorance, awareness, consideration, converted\}$. 

The intuition is that consumers with affinities for certain types of products are more likely to visit sites related to those products.

TODO: fix up this state stuff.
TODO: mere-exposure effect https://en.wikipedia.org/wiki/Mere-exposure\_effect
After each iteration of Auction Game and Ad Game, a consumer may convert, i.e. buy an advertiser's product.

TODO: conversion should occur randomly and separately from ad interactions

\subsection{Advertisers}

Again, we will begin with a formal description of an Advertiser player:

An advertiser $V_j$ is tuple $\langle t_j, \alpha_j \rangle$ where:

\begin{enumerate}
	\item $t_j \in [-1,1]^N$ is the advertiser's type
	\item $D_j$ is the set of ads available to the advertiser
\end{enumerate}

\newpage

\section{Ad Exchange Simulation}

\subsection{Agent-based Model}

\subsection{Simulation Details}

\subsection{Implementation}

Such messages are generated by rotating the consumer's type vector a random amount. Both the amount and direction of the rotation are randomly chosen at the time a message is generated. The rotation is achieved in the following way. Suppose we have a consumer with type $t_i = \frac{\bm{x}}{||\bm{x}||}$ where $\bm{x} \sim D$, e.g. the components of vector $\bm{x}$ are drawn i.i.d. from some distribution $D$. A message vector $m$ is then by $\frac{t_i + \bm{y}}{||t_i + \bm{y}||}$ with $\bm{y} \sim D$. This means that the expected value of the angle between a consumer's type and one of that consumer's messages is zero. The intuition is that consumers are likely to visit sites which suit their interests. Since consumer messages represent impression metadata and impression metadata represents the type of web site the consumer is visiting, it is likely that the impression metadata represents the consumer's type. However, there is no limitation on $D$ and so could may be plenty of variance in a consumer's messages.

\newpage

\section{Simulation Results}

\subsection{Summary}

\subsection{Naive Attribution}

\subsection{Improved Attribution}

\section{References}

\bibliography{tesis}
\bibliographystyle{plain}

\end{document}

